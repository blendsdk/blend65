// @fixture: codegen/instruction-selection/comparison-branch
// @category: codegen
// @description: Tests code generation for comparison and branching combinations
// @expect: success
// @output-contains: CMP
// @output-contains: RTS
// @tags: codegen, comparison, branch, conditional

module ComparisonBranch;

function testEquality(a: byte, b: byte): byte {
    if (a == b) {
        return 1;
    }
    return 0;
}

function testInequality(a: byte, b: byte): byte {
    if (a != b) {
        return 1;
    }
    return 0;
}

function testLessThan(a: byte, b: byte): byte {
    if (a < b) {
        return 1;
    }
    return 0;
}

function testGreaterThan(a: byte, b: byte): byte {
    if (a > b) {
        return 1;
    }
    return 0;
}

function testLessOrEqual(a: byte, b: byte): byte {
    if (a <= b) {
        return 1;
    }
    return 0;
}

function testGreaterOrEqual(a: byte, b: byte): byte {
    if (a >= b) {
        return 1;
    }
    return 0;
}

function chainedComparisons(x: byte): byte {
    if (x < 10) {
        return 0;
    } else {
        if (x < 20) {
            return 1;
        } else {
            if (x < 30) {
                return 2;
            }
        }
    }
    return 3;
}

function main(): void {
    let r1: byte = testEquality(5, 5);
    let r2: byte = testInequality(5, 10);
    let r3: byte = testLessThan(5, 10);
    let r4: byte = testGreaterThan(10, 5);
    let r5: byte = testLessOrEqual(5, 5);
    let r6: byte = testGreaterOrEqual(10, 10);
    let r7: byte = chainedComparisons(15);
    
    poke($0400, r1);
    poke($0401, r2);
    poke($0402, r3);
    poke($0403, r4);
    poke($0404, r5);
    poke($0405, r6);
    poke($0406, r7);
}